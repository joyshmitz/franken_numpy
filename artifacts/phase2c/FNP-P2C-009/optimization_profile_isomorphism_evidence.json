{
  "schema_version": 1,
  "packet_id": "FNP-P2C-009",
  "subtask_id": "FNP-P2C-009-H",
  "status": "pass",
  "optimization_lever": {
    "id": "P2C009-H-LEVER-001",
    "description": "Replace NPZ member uniqueness structure from BTreeSet to HashSet in synthesis path",
    "rationale": "Member-name uniqueness checks are membership-heavy and do not require sorted iteration; HashSet reduces lookup cost while preserving deterministic output ordering.",
    "risk_note": "Set iteration ordering is not externally observed; member emission order remains positional first then keyword order.",
    "rollback_command": "git restore --source <last-green-commit> -- crates/fnp-io/src/lib.rs"
  },
  "benchmark_delta": {
    "p50_delta_percent": -48.92548206603466,
    "p95_delta_percent": -45.23661149976157,
    "p99_delta_percent": -38.03579043616232,
    "throughput_gain_percent_p50": 95.79235212614404,
    "throughput_gain_percent_p95": 82.6037481219129
  },
  "ev_gate": {
    "formula": "(Impact * Confidence * Reuse) / (Effort * AdoptionFriction)",
    "threshold": 2.0,
    "impact": 4.0,
    "confidence": 4.0,
    "reuse": 3.0,
    "effort": 2.0,
    "adoption_friction": 1.0,
    "score": 24.0,
    "promoted": true
  },
  "isomorphism": {
    "cases_total": 4,
    "cases_passed": 4,
    "cases_failed": 0,
    "ordering_tiebreak_note": "NPZ member names remain deterministic: positional arr_N names followed by trimmed keyword names in insertion order.",
    "checks": [
      {
        "case_id": "case_valid_small",
        "status": "pass",
        "details": "baseline and optimized outputs matched"
      },
      {
        "case_id": "case_valid_large",
        "status": "pass",
        "details": "baseline and optimized outputs matched"
      },
      {
        "case_id": "case_duplicate_keyword",
        "status": "pass",
        "details": "baseline and optimized outputs matched"
      },
      {
        "case_id": "case_empty_keyword",
        "status": "pass",
        "details": "baseline and optimized outputs matched"
      }
    ]
  },
  "quality_gates": [
    {
      "command": "cargo fmt --check",
      "result": "pass"
    },
    {
      "command": "rch exec -- cargo check --workspace --all-targets",
      "result": "pass"
    },
    {
      "command": "rch exec -- cargo clippy --workspace --all-targets -- -D warnings",
      "result": "pass"
    },
    {
      "command": "rch exec -- cargo test -p fnp-io",
      "result": "pass"
    },
    {
      "command": "rch exec -- cargo run -p fnp-conformance --bin run_test_contract_gate",
      "result": "pass"
    },
    {
      "command": "rch exec -- cargo run -p fnp-conformance --bin run_security_gate",
      "result": "pass"
    },
    {
      "command": "rch exec -- cargo run -p fnp-conformance --bin run_workflow_scenario_gate -- --log-path target/workflow_scenario_packet009_opt_e2e.jsonl --artifact-index-path target/workflow_scenario_packet009_opt_artifact_index.json --report-path target/workflow_scenario_packet009_opt_reliability.json --retries 1 --flake-budget 0 --coverage-floor 1.0",
      "result": "pass"
    }
  ],
  "artifacts": [
    "crates/fnp-io/src/lib.rs",
    "crates/fnp-conformance/src/bin/generate_packet009_optimization_report.rs",
    "artifacts/phase2c/FNP-P2C-009/optimization_profile_report.json",
    "artifacts/phase2c/FNP-P2C-009/optimization_profile_isomorphism_evidence.json",
    "artifacts/phase2c/FNP-P2C-009/workflow_scenario_packet009_opt_e2e.jsonl",
    "artifacts/phase2c/FNP-P2C-009/workflow_scenario_packet009_opt_reliability.json",
    "artifacts/phase2c/FNP-P2C-009/workflow_scenario_packet009_opt_artifact_index.json"
  ],
  "notes": [
    "Baseline and rebaseline data are recorded in optimization_profile_report.json with environment fingerprint and reproducibility command.",
    "All isomorphism checks passed across valid and error-path cases (duplicate and empty keyword member names).",
    "Optimization accepted under EV gate with score 24.0 >= 2.0 and no observable behavior drift."
  ]
}
