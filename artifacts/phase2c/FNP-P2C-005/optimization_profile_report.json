{
  "schema_version": 1,
  "packet_id": "FNP-P2C-005",
  "subtask_id": "FNP-P2C-005-H",
  "generated_at_unix_ms": 1771321007135,
  "environment_fingerprint": "os=linux arch=x86_64 cpus=128 rustc=rustc 1.95.0-nightly (a423f68a0 2026-02-13)",
  "reproducibility_command": "cargo run -p fnp-conformance --bin generate_packet005_optimization_report",
  "lever": {
    "id": "P2C005-H-LEVER-001",
    "description": "Add same-shape fast path for ufunc elementwise_binary",
    "rationale": "When shapes already match, broadcasting odometer bookkeeping is unnecessary; direct zipped iteration lowers per-element overhead.",
    "risk_note": "Behavioral risk is low because fast path only triggers under exact shape equality and uses identical op/dtype semantics.",
    "rollback_command": "git restore --source <last-green-commit> -- crates/fnp-ufunc/src/lib.rs"
  },
  "baseline_profile": {
    "implementation": "baseline_odometer_path",
    "runs": 60,
    "elements_per_run": 65536,
    "percentiles": {
      "p50_ms": 3.073143,
      "p95_ms": 3.479463,
      "p99_ms": 3.537221,
      "min_ms": 3.016517,
      "max_ms": 4.030565
    },
    "throughput_elements_per_sec_p50": 21325398.78554301,
    "throughput_elements_per_sec_p95": 18835090.357333876
  },
  "rebaseline_profile": {
    "implementation": "rebaseline_same_shape_fast_path",
    "runs": 60,
    "elements_per_run": 65536,
    "percentiles": {
      "p50_ms": 0.937665,
      "p95_ms": 0.96711,
      "p99_ms": 0.986817,
      "min_ms": 0.92421,
      "max_ms": 1.022273
    },
    "throughput_elements_per_sec_p50": 69892765.53993164,
    "throughput_elements_per_sec_p95": 67764783.73711367
  },
  "delta": {
    "p50_delta_percent": -69.48840324059114,
    "p95_delta_percent": -72.20519373248113,
    "p99_delta_percent": -72.10191277276711,
    "throughput_gain_percent_p50": 227.7442370142855,
    "throughput_gain_percent_p95": 259.7794459782238
  },
  "ev": {
    "impact": 4.0,
    "confidence": 4.0,
    "reuse": 3.0,
    "effort": 2.0,
    "adoption_friction": 1.0,
    "score": 24.0,
    "promoted": true
  },
  "isomorphism_checks": [
    {
      "case_id": "case_same_shape_add",
      "status": "pass",
      "details": "baseline and optimized outputs matched"
    },
    {
      "case_id": "case_broadcast_row",
      "status": "pass",
      "details": "baseline and optimized outputs matched"
    },
    {
      "case_id": "case_scalar_broadcast",
      "status": "pass",
      "details": "baseline and optimized outputs matched"
    },
    {
      "case_id": "case_shape_error",
      "status": "pass",
      "details": "baseline and optimized outputs matched"
    }
  ]
}